{% load static %}

<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Carbonbins</title>
    <link rel="stylesheet" href="{% static 'assets/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/payment.css' %}">
</head>

<body style="background-color: #296d2d;" id="top">
<div>
    <img src="{% static 'assets/img/logo.png' %}"></div>
<div style="margin-top: 80px;font-size: 80px;"></div>
<div style="max-width: 500px;">
    <div align='left'>
        <div style="max-width: 500px;">
            <div>
                <h2 id='des' style="color: #ffffff">Complete payment</h2>
            </div>

            <div id="paypal-button-container"></div>

                        <div>
                            <form id="payment-form" method="post" action="/payment/">
                                {% csrf_token %}
                                <div id="dropin-container"></div>
            <!--                    <div class="bt-drop-in-wrapper">-->
            <!--                        <div id="bt-dropin"></div>-->
            <!--                    </div>-->
                                <input type="hidden" id="nonce" name="payment_method_nonce"/>
                                <br>
                                <button class="btn btn-primary" type="submit" id="submit-button"
                                        style="margin-top: 20px;min-width: 75%;margin-left: 25%;background-color: #cfa6cd;color: #296d2d;font-size: 18px;">
                                    <span>Complete Payment</span></button>
                            </form>
                        </div>


        </div>
    </div>
</div>
<div id="clogo" align='right'><img src="{% static 'assets/img/clogo.png' %}"></div>
<script src="{% static 'assets/js/jquery.min.js' %}"></script>
<script src="{% static 'assets/bootstrap/js/bootstrap.min.js' %}"></script>
<!--<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"-->
<!--        data-sdk-integration-source="button-factory"></script>-->
<!--<script>-->

<!--  var amount = 10;-->
<!--  paypal.Buttons({-->
<!--      style: {-->
<!--          shape: 'pill',-->
<!--          color: 'white',-->
<!--          layout: 'horizontal',-->
<!--          label: 'paypal',-->
<!--          tagline: true-->
<!--      },-->
<!--      createOrder: function(data, actions) {-->
<!--          return actions.order.create({-->
<!--              purchase_units: [{-->
<!--                  amount: {-->
<!--                      value: amount-->
<!--                  }-->
<!--              }]-->
<!--          });-->
<!--      },-->
<!--      onApprove: function(data, actions) {-->
<!--          return actions.order.capture().then(function(details) {-->
<!--              alert('Transaction completed by ' + details.payer.name.given_name + '!');-->
<!--          });-->
<!--      }-->
<!--  }).render('#paypal-button-container');-->


<!--</script>-->

<script src="https://js.braintreegateway.com/web/dropin/1.22.1/js/dropin.min.js"></script>
<script>
  var form = document.querySelector('#payment-form');
  var auth = '{{ client_token }}';

  braintree.dropin.create({
    authorization: auth,
    container: '#dropin-container',
    paypal: {
      flow: 'vault'
    }
  }, function (createErr, instance) {
    console.log('Error', createErr);
    form.addEventListener('submit', function (event) {
      event.preventDefault();
      instance.requestPaymentMethod(function (err, payload) {
        if (err) {
          console.log('Error', err);
          return;
        }

        // Add the nonce to the form and submit
        document.querySelector('#nonce').value = payload.nonce;
        form.submit();
      });
    });
  });

</script>
</body>
</html>